<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
    <title>Lecture 3- Model</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">
  </head>
  
  <body>
    <div class="container">
      <header class="row">
        <div class="span12">
          <nav class="navbar">
            <div class="navbar-inner">

            <!-- this is a title, if you put it here then it becomes part of the nav-->
              <h1><a href="”#”">iOS Introduction</a></h1>
              <a href="#" class="brand">Crash Course</a>

              <ul class="nav">
                <li class="divider-vertical"></li>
                <li><a href="./lecture_1.html">Lecture 1</a></li>
                <li class="divider-vertical"></li>
                <li><a href="./lecture_2.html">Lecture 2</a></li>
                <li class="divider-vertical"></li>
                <li class="active"><a href="./lecture_3.html">Lecture 3</a></li>
                <li class="divider-vertical"></li>
                <li><a href="./misc.html">Miscellanious</a></li>
                <li class="divider-vertical"></li>
                </li>
              </ul>
            </div>
          </nav>
        </div>
      </header>

      <div class="row">
        <div class="span2">

        </div>

        <div class="span10">
        <a href="https://docs.google.com/presentation/d/13Vi-UIiSgmtNt7IXmPeE_dvJBP0dPdxLXeDd0N5VNCk/edit?usp=sharing">Lecture 3 Slides</a>

          <p>Find the JSON needed for Part 3 of the UWMadInstagram app <a href="http://pages.cs.wisc.edu/~griepent/instagram.json">here.</a>
          </p>
	
	<h3>Introduction</h3>
	<p>In this section we will go over<p>
	<ul>
	  <li>Collecting data from a url</li>
	  <li>Passing data between views</li>
	  <li>Displaying data in a view</li>
	</ul>


	<section id = "Data Collection">
	  <div class = "page-header">
          <h3>Collecting JSON Data</h3> 

	  <p>Before we can display any data in the table view we first need to collect it. Luckily, there’s a class for that called NSURLConnection. What NSURLConnection basically does is extract data from a given URL and outputs it in a way that can be stored.<p>

		<div class="alert alert-info">
                <!-- <a href="#" class="alert-link"> -->
                <h5>Utilizing NSURLConnection</h5> 
		<ul>
		   <li>We’re going to want our own method for this so let’s make the following in the HomeViewController.m file - (void) getCommentsAndImages {</li>
		   <li>Inside the new method create the objects NSURL *url, NSURLRequest *req, and NSURLConnection *connection.</li>
		   <li> Use NSURL’s [initWithString:] method to store the url http://pages.cs.wisc.edu/~griepent/instagram.json</li>
		   <li>Use [initWithURL:] to store url into NSURLRequest req</li>
		   <li>Use NSURLConnection’s [initWithRequest:Delegate:] method using req as the request and setting delegate to “self”</li>
		   <li> Enable collecting by typing in [connection start]</li>
		</ul>
		</div>

        <p>The final result should look like this</p>

<div class="well">
                <a href="./img/lecture_3/code_seg1.png">
                  <img src="./img/lecture_3/code_seg1.png" class="img-rounded"> 
                </a>

                <div style="text-align: left;"> 
                 
 		</div>
</div>

	<p>After the object is created we then use the method [connection start] to begin the extraction. Before we can start though we first need a container for the data and to implement 4 methods from the NSURLConnection class.<p>


		<div class="alert alert-info">
                <!-- <a href="#" class="alert-link"> -->
                <h5>Utilizing NSURLConnection Pt. 2</h5> 
		<ul>
		   <li>Create an NSArray *data object. This array is going to be used by a lot of different methods later on so place it in the HomeViewController.h file with the properties Nonatomic and Strong</li>

		   <li> Create an NSMutableData *jsonResponse object in the HomeViewController.m interface and initialize it inside viewDidAppear</li>

		   <li> We still haven’t called our getCommentsAndImages method yet so let’s call it in the viewDidAppear method as well.</li>

		   <li> Copy down the following code (Remember it’s important to specify this.data when referring to the array in the header!)</li>
		</ul>
<div class="well">
                <a href="./img/lecture_3/code_seg2.png">
                  <img src="./img/lecture_3/code_seg2.png" class="img-rounded"> 
                </a>

                <div style="text-align: left;"> 
                 
 		</div>
</div>
		</div>
	
	<p>We should be all set now! With every call of didRecieveData, our connection object is now going to store pieces of the json file in to the data container jsonResponse. Once connection reaches the end it will call on the method connectionDidFinishLoading and store the contents of the data container into the data array. Recall though that the HomeViewController isn’t used to display any of this data. that’s the ImageTableViewController’s job. Now that we have the data stored we’re going to need to send it to the proper view controllers.<p>

	<p>If you would like to read more about NSURLConnection the documentation is here: https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html<p>


		</div>


	<section id = "Passing Data">
	  <div class = "page-header">
          <h3>Passing Data Between Controllers</h3> 
	
	<p>To pass data between different views in xcode we’re gonna have to establish the relationship inside the storyboard<p>

		<div class="alert alert-info">
                <!-- <a href="#" class="alert-link"> -->
                <h5>Establishing a Segue Relation</h5> 
		<ul>
		   <li>Open up the UIStoryboard in xcode</li>

		   <li>Ctrl+Click on our HomeViewController and drag the line to the ImagesTableViewController</li>

		   <li>When a menu pops up click on the “push” option</li>
		</ul>
		</div>


	<div class="well">
                <a href="./img/lecture_3/segue_line.png">
                  <img src="./img/lecture_3/segue_line.png" class="img-rounded"> 
                </a>

                <div style="text-align: left;"> 
                 <em>Creating a segue between two views</em>
 		</div>
</div>

	<p>This is what’s called a segue (pronounced “segway” though!). Basically, we just told our ImagesTableViewController to expect data to be sent from our HomeViewController. Now that we’ve established the relationship we have to specify what data we want to send over.<p>

		<div class="alert alert-info">
                <!-- <a href="#" class="alert-link"> -->
                <h5>Preparing for Segue</h5> 
		<ul>
		   <li>Inside ImagesTableViewController.h create another NSArray *data object. Use the same properties as the array in the HomeViewController.</li>

		   <li>Back to the HomeViewController.m create the following method - (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {</li>

		   <li>Copy down the following code</li>
		</ul>
<div class="well">
                <a href="./img/lecture_3/code_seg3.png">
                  <img src="./img/lecture_3/code_seg3.png" class="img-rounded"> 
                </a>

                <div style="text-align: left;"> 
                 
 		</div>
</div>
		</div>

	<p>I’ll explain what’s going on in a bit but first we have to set the identifier for our ImagesTableViewController!<p>

		<div class="alert alert-info">
                <!-- <a href="#" class="alert-link"> -->
                <h5>Setting Identifier for ImagesTableViewController</h5> 
		<ul>
		   <li>Go back to the storyboard and click on the transition icon </li>

		   <li>Go to the attributes inspector menu and give it the identifier “images”</li>
		</ul>
		</div>

<div class="well">
                <a href="./img/lecture_3/segue_identifier.png">
                  <img src="./img/lecture_3/segue_identifier.png" class="img-rounded"> 
                </a>

                <div style="text-align: left;"> 
                 <em> The segue identifier is the line connecting the two views!</em>
 		</div>
</div>

	<p>Now that we have a proper identifier the segue should work. What we’re essentially doing in this segue is creating an instance of our ImagesTableViewController class and setting it as the destination for passing data. We then set the NSArray data from the ImagesTableViewController to have the same contents as the HomeViewController data array which contains the json file. Lastly the number of images is set to equal the actual number of images contained within data. If the identifiers don’t happen to match up then the SettingsViewController is accessed instead and the delegate is set to self. This won’t work though until you establish the segue relationship with the SettingsViewController as well.<p>

		<div class="alert alert-info">
                <!-- <a href="#" class="alert-link"> -->
                <h5>Segue Between SettingsView and HomeView</h5> 
		<ul>
		   <li>You should know what to do now! Establish a segue relationship between the SettingsViewController and the HomeViewController</li>
		</ul>
		</div>
	
	<p>We still need to perform one more segue though!<p>

		<div class="alert alert-info">
                <!-- <a href="#" class="alert-link"> -->
                <h5>Segue Between ImagesTableViewController and CommentsViewController</h5> 
		<ul>
		   <li>Set up a segue between the ImagesTableViewController and the CommentViewController</li>

		   <li>Inside the CommentViewController.h create an NSDictionary *data object</li>

		   <li>Inside the ImagesTableViewController.m copy the following code</li>
		</ul>
<div class="well">
                <a href="./img/lecture_3/code_seg4.png">
                  <img src="./img/lecture_3/code_seg4.png" class="img-rounded"> 
                </a>

                <div style="text-align: left;"> 
                 
 		</div>
</div>
		</div>

	<p>Now we’ve managed to move the instagram feed data from the HomeViewController to the CommentViewController where we can display the images using the IBOutlets.<p>

		</div>

	<section id = "Displaying Images">
	  <div class = "page-header">
          <h3>Displaying Images and Comments</h3> 

	<p>We're finally at a location where we can actually display some pictures! We're not quite there yet though. Recall that the data we’ve been moving around is a huge chunk of text and not all of the information included is relevant to our instagram clone. To get the proper data, we’re going to have to parse the file, and, at the same time, we're going to send this data to our IBOutlets.<p>

		<div class="alert alert-info">
                <!-- <a href="#" class="alert-link"> -->
                <h5>Parsing </h5> 
		<ul>
		   <li>Inside the CommentViewController.m copy the following code</li>
		</ul>
<div class="well">
                <a href="./img/lecture_3/code_seg5.png">
                  <img src="./img/lecture_3/code_seg5.png" class="img-rounded"> 
                </a>

                <div style="text-align: left;"> 
                 
 		</div>
</div>
		</div>

	<p>A json file can be thought of as an ordered collection of NSDictionary Objects that itself contains more NSDictionary Objects which can repeat until the actual data you are looking for is reached. To traverse through the dictionaries you need to use a key which was explained in the lecture 2 notes. In this instance, we are using the keys “images” and “standard_resolution” to find the pictures and “caption” and “text” for the comments.<p>

	<p>To display the pictures and text we use the methods setImage and setText respectively to change the display of the UIImageView andUITextView IBOutlets. Lastly, we utilize the ViewDidAppear method so that a new image will load every time the views are loaded up.<p>

	<p>Try running your app now. If it's all working then your app should be displaying pictures now!<p>
		
		

	</div>

        </div>

      </div>

      <div class="row" id="main-content"></div>
      <footer class="row">
        <hr>
      </footer>

    </div>

    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>
